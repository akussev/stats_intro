size(250,0);
import graph;

path p_cdf = (-3, 0);
path p_ecdf = (-3, 0);

real[] a = {-3, -2.3015387 , -2.06014071, -1.10061918, -1.09989127, -1.07296862,
       -0.93576943, -0.87785842, -0.7612069 , -0.68372786, -0.61175641,
       -0.52817175, -0.38405435, -0.3224172 , -0.26788808, -0.24937038,
       -0.17242821, -0.12289023,  0.04221375,  0.3190391 ,  0.50249434,
        0.53035547,  0.58281521,  0.86540763,  0.90085595,  0.90159072,
        1.13376944,  1.14472371,  1.46210794,  1.62434536,  1.74481176, 3};
        
real[] grid = {
    -3.  , -2.94, -2.88, -2.82, -2.76, -2.7 , -2.64, -2.58, -2.52,
       -2.46, -2.4 , -2.34, -2.28, -2.22, -2.16, -2.1 , -2.04, -1.98,
       -1.92, -1.86, -1.8 , -1.74, -1.68, -1.62, -1.56, -1.5 , -1.44,
       -1.38, -1.32, -1.26, -1.2 , -1.14, -1.08, -1.02, -0.96, -0.9 ,
       -0.84, -0.78, -0.72, -0.66, -0.6 , -0.54, -0.48, -0.42, -0.36,
       -0.3 , -0.24, -0.18, -0.12, -0.06,  0.  ,  0.06,  0.12,  0.18,
        0.24,  0.3 ,  0.36,  0.42,  0.48,  0.54,  0.6 ,  0.66,  0.72,
        0.78,  0.84,  0.9 ,  0.96,  1.02,  1.08,  1.14,  1.2 ,  1.26,
        1.32,  1.38,  1.44,  1.5 ,  1.56,  1.62,  1.68,  1.74,  1.8 ,
        1.86,  1.92,  1.98,  2.04,  2.1 ,  2.16,  2.22,  2.28,  2.34,
        2.4 ,  2.46,  2.52,  2.58,  2.64,  2.7 ,  2.76,  2.82,  2.88,
        2.94,  3.
};

real[] cdf = {
    0.0013499 , 0.00164106, 0.00198838, 0.00240118, 0.00289007,
       0.00346697, 0.0041453 , 0.00494002, 0.00586774, 0.00694685,
       0.00819754, 0.00964187, 0.01130384, 0.01320938, 0.01538633,
       0.01786442, 0.02067516, 0.02385176, 0.02742895, 0.03144276,
       0.03593032, 0.04092951, 0.04647866, 0.05261614, 0.05937994,
       0.0668072 , 0.0749337 , 0.08379332, 0.09341751, 0.10383468,
       0.11506967, 0.12714315, 0.14007109, 0.15386423, 0.16852761,
       0.18406013, 0.20045419, 0.21769544, 0.2357625 , 0.25462691,
       0.27425312, 0.29459852, 0.3156137 , 0.33724273, 0.35942357,
       0.38208858, 0.40516513, 0.42857628, 0.45224157, 0.47607782,
       0.5       , 0.52392218, 0.54775843, 0.57142372, 0.59483487,
       0.61791142, 0.64057643, 0.66275727, 0.6843863 , 0.70540148,
       0.72574688, 0.74537309, 0.7642375 , 0.78230456, 0.79954581,
       0.81593987, 0.83147239, 0.84613577, 0.85992891, 0.87285685,
       0.88493033, 0.89616532, 0.90658249, 0.91620668, 0.9250663 ,
       0.9331928 , 0.94062006, 0.94738386, 0.95352134, 0.95907049,
       0.96406968, 0.96855724, 0.97257105, 0.97614824, 0.97932484,
       0.98213558, 0.98461367, 0.98679062, 0.98869616, 0.99035813,
       0.99180246, 0.99305315, 0.99413226, 0.99505998, 0.9958547 ,
       0.99653303, 0.99710993, 0.99759882, 0.99801162, 0.99835894,
       0.9986501
};

real coef = 3;

for (int i = 0; i < 100; i += 1) {
  p_cdf = p_cdf--(grid[i], coef * cdf[i]);
}

pen pe = heavygreen+1bp;
draw(p_cdf, pe);

pen pe_ecdf = heavyred+1bp;
pen pe_dot = heavyred+0.3bp;
draw((a[0], 0)--(a[1], 0), pe_ecdf);
dot((a[1], 0), filltype=FillDraw(white), pe_dot);
for (int i = 1; i < 31; i += 1) {
    draw((a[i], coef * i / 30)--(a[i + 1], coef * i / 30), pe_ecdf);
    dot((a[i + 1], coef * i / 30), filltype=FillDraw(white), pe_dot);
    dot((a[i], coef * i / 30), filltype=FillDraw(), pe_dot);
}
        
real start=-3.1, finish = 3.1;

pen rp = 2bp+heavyred;
pen gp = 2bp+heavygreen;

pen bpen = black+dashed;
pen bpen2 = black+dotted;

picture p_new, p_old;

yaxis(L="", EndArrow, ymax=coef * 1.1, ymin=coef * -0.1, axis=XEquals(0));
xaxis(L="$x$", EndArrow, xmin=start, xmax=finish, axis=YEquals(0));

label("$F(x)$", (2, coef * 0.7), heavygreen);
label("$F^*(x)$", (-1, coef * 0.5), heavyred);
